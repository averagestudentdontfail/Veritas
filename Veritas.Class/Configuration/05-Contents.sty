%%% Configuration/05-Contents.sty %%%
%%% Table of Contents Configuration for Veritas Template
%%%
%%% FIRST PRINCIPLES BASIS:
%%% This module implements ToC design derived from:
%%%
%%% 1. Ritter, R.M. (2002). The Oxford Guide to Style.
%%%    - Table of contents as structural overview
%%%    - Hierarchical indentation for section levels
%%%
%%% 2. Bringhurst, R. (2012). The Elements of Typographic Style.
%%%    - Leader dots for horizontal connection (ยง8.3)
%%%    - Italic for front/back matter distinction
%%%
%%% COMPLIANCE: Standard.md
%%% - LOC-1 Rule 1: LaTeX2e conformant
%%% - LOC-4 Rule 14: Semantic environments for ToC entries

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{05-Contents}[2025/12/12 v1.0.0 Veritas ToC Configuration]

%%% Custom ToC Entries %%%
\newcommand{\bookmarktocentry}{\pdfbookmark[0]{\contentsname}{toc}}
\ProvideDocumentCommand\MakeLinkTarget{sO{}m}{}

\NewCommandCopy\l@frontmatter\l@chapter
\NewCommandCopy\l@backmatter\l@chapter

\providecommand*{\toclevel@frontmatter}{0}
\providecommand*{\toclevel@backmatter}{0}

%%% Front/Back Matter Styling %%%
% Italic distinguishes auxiliary matter from main chapters
\patchcmd{\l@frontmatter}{\bfseries}{\miniondisplayfont\itshape}{}{}
\patchcmd{\l@frontmatter}{\nobreak\hfil}{\upshape\nobreak\hfil}{}{}
\patchcmd{\l@frontmatter}{1.0em}{3pt}{}{}
\patchcmd{\l@backmatter}{\bfseries}{\miniondisplayfont\itshape}{}{}
\patchcmd{\l@backmatter}{\nobreak\hfil}{\upshape\nobreak\hfil}{}{}

%%% Part Entries in TOC %%%
\renewcommand*\l@part[2]{%
  \ifnum \c@tocdepth >-2\relax
    \addpenalty{-\@highpenalty}%
    \addvspace{1em \@plus\p@}%
    \setlength\@tempdima{3em}%
    \begingroup
      \parindent \z@ \rightskip \@pnumwidth
      \parfillskip -\@pnumwidth
      {\leavevmode
       \large\miniondisplayfont\bfseries #1\hfil
       \hb@xt@\@pnumwidth{\hss}}\par
       \nobreak
         \global\@nobreaktrue
         \everypar{\global\@nobreakfalse\everypar{}}%
    \endgroup
  \fi}

%%% Enhanced List of Figures %%%
\patchcmd{\listoffigures}
{\chapter*{\listfigurename}}
{\chapter*{\miniondisplayfont\listfigurename}\MakeLinkTarget*{listoffigures}%
\addcontentsline{toc}{frontmatter}{\listfigurename}}{}{}

%%% Enhanced List of Tables %%%
\patchcmd{\listoftables}
{\chapter*{\listtablename}}
{\chapter*{\miniondisplayfont\listtablename}\MakeLinkTarget*{listoftables}%
\addcontentsline{toc}{frontmatter}{\listtablename}}{}{}

%%% Bibliography Heading %%%
\defbibheading{bibintoc}{%
    \clearpage%
    \chapter*{\miniondisplayfont#1}%
    \thispagestyle{plain}%
    \markboth{\miniondisplayfont\fontsize{10}{12}\selectfont\bfseries#1}{}%
    \addcontentsline{toc}{backmatter}{\refname}%
}

%%% Glossary ToC Entries %%%
\newcommand{\glossarytoc}{\MakeLinkTarget*{glossary}%
\addcontentsline{toc}{frontmatter}{\glossaryname}}

\newcommand{\acronymtoc}{\MakeLinkTarget*{acronym}%
\addcontentsline{toc}{frontmatter}{\acronymname}}

\newcommand{\symboltoc}{\MakeLinkTarget*{symbol}%
\addcontentsline{toc}{frontmatter}{\glssymbolsgroupname}}

%%% Figure and Table ToC Entry Formatting %%%
\renewcommand*\l@figure{\@dottedtocline{1}{0em}{2.3em}}
\let\l@table\l@figure