%%% Configuration/10-Macros.sty %%%
%%% Document Macros for Veritas Template
%%%
%%% FIRST PRINCIPLES BASIS:
%%% This module implements semantic commands derived from:
%%%
%%% 1. Lamport, L. (1994). LaTeX: A Document Preparation System.
%%%    - Logical markup over visual markup
%%%    - Author focuses on content, not presentation
%%%
%%% 2. Knuth, D.E. (1986). The TeXbook.
%%%    - Macro abstraction for reusability
%%%    - Consistent formatting through single definitions
%%%
%%% 3. Standard.md LOC-4 Rule 11
%%%    - Raw \def shall not appear in document bodies
%%%    - Semantic commands for content/presentation separation
%%%
%%% COMPLIANCE: Standard.md
%%% - LOC-1 Rule 1: LaTeX2e conformant
%%% - LOC-4 Rule 11: Separation of content and presentation
%%% - LOC-4 Rule 13: Single-purpose, composable macros

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{10-Macros}[2025/12/12 v1.0.0 Veritas Document Macros]

%%% Paragraph Formatting %%%
% No indent, space between paragraphs (modern document style)
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}

%%% Blank Page Command %%%
% Intentionally blank page for book printing
\newcommand\blankpage{
    \clearpage
    \thispagestyle{empty}%
    \vspace*{\fill}
    \begin{center}
        \ifthenelse{\equal{\LanguageOption}{portuguese}}{%
            \textcolor{gray!50}{\textit{Página intencionalmente deixada em branco.}}
        }{%
            \textcolor{gray!50}{\textit{This page intentionally left blank.}}
        }
    \end{center}
    \vspace*{\fill}
    \clearpage
} 

\newcommand{\plainblankpage}{\thispagestyle{plain}\blankpage}

%%% Guide Information Blocks %%%
\newcommand{\guideinfo}[1]{%
    \ifthenelse{\equal{\LanguageOption}{portuguese}}{%
        \noindent\textcolor{note}{\faInfoCircle\ \textbf{Orientação Para a Escrita}}%
    }{
        \noindent\textcolor{note}{\faInfoCircle\ \textbf{Writing Guidance}}%
    }
    \\[.55em]%
    \noindent #1%
}

\newcommand{\exampleinfo}[1]{%
    \ifthenelse{\equal{\LanguageOption}{portuguese}}{%
        \noindent\textcolor{black}{\faInfoCircle\ \textbf{Exemplo de Utilização}}%
    }{
        \noindent\textcolor{black}{\faInfoCircle\ \textbf{Example of Use}}%
    }
    \\[.55em]%
    \noindent #1%
}

%%% Abstract Keywords %%%
\NewDocumentCommand{\keywordsen}{m}{\vspace{.4cm}\noindent\textbf{Keywords:} #1}
\NewDocumentCommand{\keywordspt}{m}{\vspace{.4cm}\noindent\textbf{Palavras-Chave:} #1}

%%% Landscape Mode Support %%%
\def\ifGm@preamble#1{\@firstofone}
\appto\restoregeometry{%
    \pdfpagewidth=\paperwidth
    \pdfpageheight=\paperheight}
\apptocmd\newgeometry{%
    \pdfpagewidth=\paperwidth
    \pdfpageheight=\paperheight}{}{}

%%% Semantic Block Environment %%%
% Markdown-style callout blocks (note, tip, warning, todo)
\newtcolorbox[auto counter,number within=section]{block}[1][]{
    enhanced jigsaw,
    coltitle=#1,
    colback=#1!08!white,
    colframe=#1!08!white,
    fonttitle=\miniondisplayfont\bfseries,
    sharp corners=west,
    detach title,
    borderline west={.85mm}{0pt}{#1},
    pad at break=1mm,
    top=4mm,
    bottom=4mm,
    title={\ifstrequal{#1}{todo}{To-Do}{\capitalisewords{#1}}},
    code={\ifdefempty{\tcbtitletext}{}{\tcbset{before upper={\tcbtitle\par\medskip}}}},
}

%%% Custom Quote Block %%%
\AtBeginDocument{%
    \renewenvironment{displayquote}{%
        \begin{tcolorbox}[
            colback=gray!3,
            colframe=burgundy!60,
            boxrule=0pt,
            leftrule=2.5pt,
            arc=0pt,
            boxsep=0pt,
            left=12pt,
            right=0pt,
            top=8pt,
            bottom=8pt,
            fontupper=\itshape,
            before skip=10pt plus 2pt,
            after skip=10pt plus 2pt,
            parbox=false
        ]%
    }{%
        \end{tcolorbox}%
    }%
}

%%% Autoref Capitalisation %%%
\addto\extrasenglish{\def\figureautorefname{Figure}}
\addto\extrasenglish{\def\chapterautorefname{Chapter}}
\addto\extrasenglish{\def\sectionautorefname{Section}}
\addto\extrasenglish{\def\subsectionautorefname{Section}}
\addto\extrasenglish{\def\subsubsectionautorefname{Section}}
\addto\extrasenglish{\def\tableautorefname{Table}}
\addto\extrasenglish{\def\partautorefname{Part}}
\addto\extrasenglish{\def\appendixautorefname{Appendix}}
\addto\extrasgerman{\def\figureautorefname{Abbildung}}
\addto\extrasgerman{\def\chapterautorefname{Kapitel}}
\addto\extrasgerman{\def\sectionautorefname{Abschnitt}}
\addto\extrasgerman{\def\subsectionautorefname{Abschnitt}}
\addto\extrasgerman{\def\subsubsectionautorefname{Abschnitt}}
\addto\extrasgerman{\def\tableautorefname{Tabelle}}
\addto\extrasgerman{\def\partautorefname{Teil}}
\addto\extrasgerman{\def\appendixautorefname{Anhang}}

%%% Color Override Utility %%%
\newcommand{\overwritecolor}[2]{%
    \textcolor{#1}{%
        \renewcommand\color[2][]{}%
    #2}%
}

%%% Glossary Print Commands %%%
\newcommand{\printnormalglossary}{\printglossary}
\newcommand{\printacronymglossary}{\printglossary[type=\acronymtype]}
\newcommand{\printsymbolglossary}{\printglossary[type=symbols]}

%%% Media-Aware Page Logic %%%
\newcommand{\MediaOptionLogic}{%
    \ifthenelse{\equal{\MediaOption}{paper}}{\plainblankpage}{\thispagestyle{plain}}%
}

\newcommand{\MediaOptionLogicAcr}{%
    \ifthenelse{\equal{\MediaOption}{paper}}{\plainblankpage}{\clearpage\thispagestyle{plain}}%
}

\newcommand{\MediaOptionLogicBlank}{%
    \ifthenelse{\equal{\MediaOption}{paper}}{\blankpage}{}%
}

\newcommand{\MediaOptionLogicAnnexes}{%
    \ifthenelse{\equal{\MediaOption}{paper}}{\blankpage}{\clearpage}%
}

%%% Apply Media Logic to Standard Commands %%%
\apptocmd{\tableofcontents}{\MediaOptionLogic}{}{\fail}
\apptocmd{\listoffigures}{\MediaOptionLogic}{}{\fail}
\apptocmd{\listoftables}{\MediaOptionLogic}{}{\fail}
\apptocmd{\printnormalglossary}{\MediaOptionLogic}{}{\fail}
\apptocmd{\printacronymglossary}{\MediaOptionLogicAcr}{}{\fail}
\apptocmd{\printsymbolglossary}{\MediaOptionLogicAcr}{}{\fail}
\pretocmd{\printbibliography}{\MediaOptionLogic}{}{\fail}
