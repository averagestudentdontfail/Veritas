%%% Veritas Pandoc Template %%%
%%% Converts Markdown to LaTeX using Veritas class
%%%
%%% YAML Frontmatter Variables:
%%%   title: Document title
%%%   subtitle: Document subtitle (optional)
%%%   author: Author name or list
%%%   date: Publication date
%%%   lang: en or de
%%%   chapterstyle: minimal, classic, fancy, modern
%%%   abstract: Abstract text (optional)

\documentclass[
    language=en,
    chapterstyle=minimal,
    media=screen,
    doctype=article
]{Veritas}

%%% Metadata from YAML %%%
\Title{The Integral of 1/(xâ¿ + 1)}
\Subtitle{A Complete Treatment}
\FirstAuthor{}
\Date{December 2025}

%%% Pandoc Compatibility %%%
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% CSL References for Pandoc citeproc
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2]%
  {\clearpage%
   \section*{References}%
   \addcontentsline{toc}{section}{References}%
   \setlength{\parindent}{0pt}%
   \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces}%
  {\par}
\newcommand{\CSLBlock}[1]{\hfill\break#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\dimexpr\linewidth-\csllabelwidth\relax}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\begin{document}

%%% Title Page %%%
\pagenumbering{gobble}
\include{Matter/Title-Page}

%%% Abstract (if present) %%%

%%% Main Content %%%
\pagenumbering{arabic}
\pagestyle{mainmatter}

% Fix section numbering for article mode (remove chapter prefix)
\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\thesubsection.\arabic{subsubsection}}

\hypertarget{preliminaries}{%
\section{Preliminaries}\label{preliminaries}}

Let \(n \geq 2\) be a positive integer. The polynomial
\(P(x) = x^n + 1\) has \(n\) distinct roots in \(\mathbb{C}\), obtained
by solving \(x^n = -1 = e^{i\pi(2m+1)}\) for any integer \(m\):

\[\omega_j := e^{i\pi(2j+1)/n}, \qquad j = 0, 1, \ldots, n-1\]

These roots lie on the unit circle, equally spaced at angular intervals
of \(2\pi/n\), with the first root at angle \(\pi/n\) from the positive
real axis.

\textbf{Conjugate structure.} The roots satisfy
\(\overline{\omega_j} = \omega_{n-1-j}\). When \(n\) is odd, exactly one
root is real: \(\omega_{(n-1)/2} = e^{i\pi} = -1\). When \(n\) is even,
all roots are non-real.

\textbf{Index convention.} For each
\(k \in \{0, 1, \ldots, \lfloor(n-2)/2\rfloor\}\), define:

\[\theta_k := \frac{\pi(2k+1)}{n} \in (0, \pi)\]

\[c_k := \cos\theta_k, \qquad s_k := \sin\theta_k > 0\]

\[Q_k(x) := x^2 - 2c_k x + 1 = (x - c_k)^2 + s_k^2\]

The restriction \(\theta_k \in (0, \pi)\) ensures \(s_k > 0\) and
selects exactly one representative from each conjugate pair of non-real
roots.

\textbf{Lemma (Real Factorisation).} \emph{The polynomial \(x^n + 1\)
factors over \(\mathbb{R}\) as follows:}

\emph{Case I (\(n\) odd):}
\[x^n + 1 = (x + 1)\prod_{k=0}^{(n-3)/2} Q_k(x)\]

\emph{Case II (\(n\) even):} \[x^n + 1 = \prod_{k=0}^{n/2-1} Q_k(x)\]

\emph{Proof.} Each conjugate pair \(\omega_j, \overline{\omega_j}\) with
argument \(\theta \in (0, \pi)\) (i.e., \(\omega_j = e^{i\theta}\),
\(\overline{\omega_j} = e^{-i\theta}\) for a unique
\(\theta = \theta_k\)) contributes the real quadratic
\((x - \omega_j)(x - \overline{\omega_j}) = x^2 - 2\operatorname{Re}(\omega_j)x + |\omega_j|^2 = Q_k(x)\).
The quadratics are irreducible over \(\mathbb{R}\) since their
discriminant \(4c_k^2 - 4 = -4s_k^2 < 0\). For odd \(n\), the real root
\(\omega_{(n-1)/2} = -1\) contributes the linear factor \((x + 1)\).
Counting degrees: for odd \(n\), \((n-1)/2\) quadratics contribute
degree \(n - 1\), plus one linear factor, totalling \(n\); for even
\(n\), \(n/2\) quadratics contribute degree \(n\). \(\blacksquare\)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{main-theorem}{%
\section{Main Theorem}\label{main-theorem}}

\textbf{Theorem.} \emph{An antiderivative of \(\dfrac{1}{x^n + 1}\) is
given by:}

\emph{Case I (\(n\) odd):}
\[\int\frac{dx}{x^n+1} = \frac{1}{n}\ln|x+1| + \sum_{k=0}^{(n-3)/2}\left[-\frac{c_k}{n}\ln Q_k(x) + \frac{2s_k}{n}\arctan\frac{x - c_k}{s_k}\right] + C\]

\emph{Case II (\(n\) even):}
\[\int\frac{dx}{x^n+1} = \sum_{k=0}^{n/2-1}\left[-\frac{c_k}{n}\ln Q_k(x) + \frac{2s_k}{n}\arctan\frac{x - c_k}{s_k}\right] + C\]

\emph{where \(c_k = \cos\theta_k\), \(s_k = \sin\theta_k\),
\(\theta_k = \pi(2k+1)/n\), and \(Q_k(x) = x^2 - 2c_k x + 1\).}

\textbf{Domain of validity.} For odd \(n\), the formula holds on
\((-\infty, -1)\) and \((-1, \infty)\) separately, with potentially
different constants of integration on each interval. For even \(n\), the
formula holds on all of \(\mathbb{R}\).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{proof}{%
\section{Proof}\label{proof}}

The argument proceeds in three steps: partial fraction decomposition via
residues, reduction to real form by pairing conjugate roots, and
integration of each component term.

\hypertarget{step-1.-partial-fraction-decomposition}{%
\subsection{Step 1. Partial Fraction
Decomposition}\label{step-1.-partial-fraction-decomposition}}

Since \(P(x) = x^n + 1\) has derivative \(P'(x) = nx^{n-1}\), and
\(P'(\omega_j) = n\omega_j^{n-1} \neq 0\) for all \(j\), the roots are
simple. For a polynomial with simple roots \(\{\alpha_j\}\), the partial
fraction decomposition of \(1/P(x)\) takes the form:

\[\frac{1}{P(x)} = \sum_j \frac{r_j}{x - \alpha_j}, \qquad r_j = \operatorname{Res}_{x = \alpha_j}\frac{1}{P(x)} = \frac{1}{P'(\alpha_j)}\]

To verify this identity, observe that both sides are rational functions
with the same simple poles and the same principal part at each pole.
Their difference is therefore a rational function with no poles, hence a
polynomial. Since this difference tends to \(0\) as \(x \to \infty\), it
must be identically \(0\).

Applying this to \(P(x) = x^n + 1\) with roots \(\omega_j\):

\[r_j = \frac{1}{P'(\omega_j)} = \frac{1}{n\omega_j^{n-1}}\]

To simplify, observe that \(\omega_j^n = -1\) implies
\(\omega_j^{n-1} = \omega_j^n / \omega_j = -\omega_j^{-1}\). Therefore:

\[r_j = \frac{1}{n(-\omega_j^{-1})} = -\frac{\omega_j}{n}\]

This yields the complex partial fraction decomposition:

\[\frac{1}{x^n + 1} = -\frac{1}{n}\sum_{j=0}^{n-1}\frac{\omega_j}{x - \omega_j}\]

When \(n\) is odd, the index \(j = (n-1)/2\) corresponds to
\(\omega_j = e^{i\pi} = -1\), and the associated term is:

\[-\frac{1}{n} \cdot \frac{-1}{x - (-1)} = \frac{1}{n} \cdot \frac{1}{x + 1}\]

\hypertarget{step-2.-pairing-conjugate-roots}{%
\subsection{Step 2. Pairing Conjugate
Roots}\label{step-2.-pairing-conjugate-roots}}

For each index \(k\) in the range
\(\{0, 1, \ldots, \lfloor(n-2)/2\rfloor\}\), let
\(\omega = \omega_k = e^{i\theta_k}\) and
\(\bar{\omega} = e^{-i\theta_k}\) be the corresponding conjugate pair
(indeed \(\bar{\omega} = \omega_{n-1-k}\)). Their combined contribution
to the partial fraction decomposition is:

\[-\frac{1}{n}\left(\frac{\omega}{x - \omega} + \frac{\bar{\omega}}{x - \bar{\omega}}\right) = -\frac{1}{n} \cdot \frac{\omega(x - \bar{\omega}) + \bar{\omega}(x - \omega)}{(x - \omega)(x - \bar{\omega})}\]

\textbf{Denominator.} Using
\(\omega + \bar{\omega} = 2\cos\theta_k = 2c_k\) and
\(\omega\bar{\omega} = |\omega|^2 = 1\):

\[(x - \omega)(x - \bar{\omega}) = x^2 - (\omega + \bar{\omega})x + \omega\bar{\omega} = x^2 - 2c_k x + 1 = Q_k(x)\]

\textbf{Numerator.} Expanding:

\[\omega(x - \bar{\omega}) + \bar{\omega}(x - \omega) = (\omega + \bar{\omega})x - \omega\bar{\omega} - \bar{\omega}\omega = 2c_k x - 2\]

Therefore the paired fraction becomes:

\[-\frac{1}{n} \cdot \frac{2c_k x - 2}{Q_k(x)} = \frac{A_k x + B_k}{Q_k(x)}\]

with coefficients:

\[A_k = -\frac{2c_k}{n}, \qquad B_k = \frac{2}{n}\]

\hypertarget{step-3.-integration-of-quadratic-terms}{%
\subsection{Step 3. Integration of Quadratic
Terms}\label{step-3.-integration-of-quadratic-terms}}

Fix an index \(k\), and write \(c = c_k\), \(s = s_k\),
\(Q(x) = Q_k(x) = (x - c)^2 + s^2\), \(A = A_k\), \(B = B_k\). Note that
\(Q'(x) = 2(x - c)\).

\textbf{Numerator decomposition.} We seek constants \(\alpha\) and
\(\beta\) such that:

\[Ax + B = \alpha \cdot Q'(x) + \beta = 2\alpha(x - c) + \beta\]

Matching coefficients: \(2\alpha = A\) and \(-2\alpha c + \beta = B\).
Hence \(\alpha = A/2\) and \(\beta = B + Ac\).

\textbf{Evaluation of \(\beta\):}

\[\beta = B + Ac = \frac{2}{n} + \left(-\frac{2c}{n}\right)c = \frac{2}{n}(1 - c^2) = \frac{2s^2}{n}\]

\textbf{Integration.} The integral separates into two standard forms:

\[\int\frac{Ax + B}{Q(x)}\,dx = \frac{A}{2}\int\frac{Q'(x)}{Q(x)}\,dx + \beta\int\frac{dx}{(x-c)^2 + s^2}\]

The first integral is \(\ln Q(x)\). For the second, the substitution
\(u = (x - c)/s\) gives \(du = dx/s\), whence:

\[\int\frac{dx}{(x-c)^2 + s^2} = \int\frac{s\,du}{s^2(u^2 + 1)} = \frac{1}{s}\arctan u = \frac{1}{s}\arctan\frac{x-c}{s}\]

Substituting \(A/2 = -c/n\) and \(\beta/s = 2s^2/(ns) = 2s/n\):

\[\int\frac{Ax + B}{Q(x)}\,dx = -\frac{c}{n}\ln Q(x) + \frac{2s}{n}\arctan\frac{x - c}{s} + C\]

\textbf{Assembly.} Summing over all conjugate pairs (indexed by \(k\))
and including the linear term \((1/n)\ln|x + 1|\) when \(n\) is odd
yields the stated formula. \(\blacksquare\)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{complex-logarithmic-form}{%
\section{Complex Logarithmic Form}\label{complex-logarithmic-form}}

\textbf{Corollary.} \emph{On any simply connected domain
\(D \subset \mathbb{C}\) avoiding the roots \(\{\omega_j\}\), with a
fixed branch of \(\log\) on \(D\):}

\[\int\frac{dx}{x^n+1} = -\frac{1}{n}\sum_{j=0}^{n-1}\omega_j\log(x - \omega_j) + C\]

\emph{Proof.} Integrate the complex partial fraction decomposition term
by term. \(\blacksquare\)

\textbf{Remark on branches.} On a simply connected domain avoiding the
poles, fixing a branch of \(\log\) renders the expression single-valued.
Changing branches shifts the result by a constant, since the derivative
is unchanged. Choose \(D\) to be conjugation-invariant (i.e.,
\(z \in D \Rightarrow \bar{z} \in D\)) and choose a branch of \(\log\)
on \(D\) satisfying \(\log(\bar{z}) = \overline{\log z}\). Then for real
\(x \in D\), we have \(\overline{x - \omega} = x - \bar{\omega}\), so
\(\log(x - \bar{\omega}) = \overline{\log(x - \omega)}\). Hence
\(\omega\log(x - \omega) + \bar{\omega}\log(x - \bar{\omega})\) is real,
and pairing conjugates yields a real-valued antiderivative; branch
changes affect only the additive constant on each component.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{application-the-case-n-5}{%
\section{\texorpdfstring{Application: The Case
\(n = 5\)}{Application: The Case n = 5}}\label{application-the-case-n-5}}

Setting \(n = 5\), the index set is \(k \in \{0, 1\}\), corresponding to
angles \(\theta_0 = \pi/5\) and \(\theta_1 = 3\pi/5\).

\textbf{Trigonometric values.} The cosine values follow from the
identity \(\cos(\pi/5) = (1 + \sqrt{5})/4\) and
\(\cos(3\pi/5) = -\cos(2\pi/5) = (1 - \sqrt{5})/4\). The sine values
follow from \(\sin^2\theta + \cos^2\theta = 1\):

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
& \(k = 0\) & \(k = 1\) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\(\theta_k\) & \(\pi/5\) & \(3\pi/5\) \\
\(c_k\) & \((1 + \sqrt{5})/4\) & \((1 - \sqrt{5})/4\) \\
\(s_k\) & \(\sqrt{10 - 2\sqrt{5}}/4\) & \(\sqrt{10 + 2\sqrt{5}}/4\) \\
\(-c_k/5\) & \(-(1 + \sqrt{5})/20\) & \((\sqrt{5} - 1)/20\) \\
\(2s_k/5\) & \(\sqrt{10 - 2\sqrt{5}}/10\) &
\(\sqrt{10 + 2\sqrt{5}}/10\) \\
\end{longtable}

\textbf{Arctangent arguments.} For \(k = 0\):

\[\frac{x - c_0}{s_0} = \frac{x - \frac{1 + \sqrt{5}}{4}}{\frac{\sqrt{10 - 2\sqrt{5}}}{4}} = \frac{4x - 1 - \sqrt{5}}{\sqrt{10 - 2\sqrt{5}}}\]

For \(k = 1\):

\[\frac{x - c_1}{s_1} = \frac{x - \frac{1 - \sqrt{5}}{4}}{\frac{\sqrt{10 + 2\sqrt{5}}}{4}} = \frac{4x - 1 + \sqrt{5}}{\sqrt{10 + 2\sqrt{5}}}\]

\textbf{Final formula:}

\[\int\frac{dx}{x^5 + 1} = \frac{1}{5}\ln|x+1| - \frac{1 + \sqrt{5}}{20}\ln\left(x^2 - \frac{1+\sqrt{5}}{2}x + 1\right) + \frac{\sqrt{5}-1}{20}\ln\left(x^2 + \frac{\sqrt{5}-1}{2}x + 1\right)\]

\[+ \frac{\sqrt{10 - 2\sqrt{5}}}{10}\arctan\frac{4x - 1 - \sqrt{5}}{\sqrt{10 - 2\sqrt{5}}} + \frac{\sqrt{10 + 2\sqrt{5}}}{10}\arctan\frac{4x - 1 + \sqrt{5}}{\sqrt{10 + 2\sqrt{5}}} + C\]

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{generalisations}{%
\section{Generalisations}\label{generalisations}}

\hypertarget{the-family-xn-an}{%
\subsection{\texorpdfstring{The family
\(x^n + a^n\)}{The family x\^{}n + a\^{}n}}\label{the-family-xn-an}}

For real \(a \neq 0\), the substitution \(x = au\) yields:

\[\int\frac{dx}{x^n + a^n} = \frac{1}{a^{n-1}}\int\frac{du}{u^n + 1}\]

The main theorem then applies directly to the transformed integral.

\hypertarget{the-family-xn---1}{%
\subsection{\texorpdfstring{The family
\(x^n - 1\)}{The family x\^{}n - 1}}\label{the-family-xn---1}}

The roots of \(x^n - 1 = 0\) are \(\zeta_j = e^{2\pi i j/n}\) for
\(j = 0, 1, \ldots, n-1\). The same method yields residues:

\[r_j = \frac{1}{n\zeta_j^{n-1}} = \frac{\zeta_j}{n}\]

since \(\zeta_j^n = 1\) implies \(\zeta_j^{n-1} = \zeta_j^{-1}\). The
decomposition becomes:

\[\frac{1}{x^n - 1} = \frac{1}{n}\sum_{j=0}^{n-1}\frac{\zeta_j}{x - \zeta_j}\]

\textbf{Real roots.} The polynomial \(x^n - 1\) always has the real root
\(\zeta_0 = 1\), contributing a term:

\[\frac{1}{n} \cdot \frac{1}{x - 1}\]

When \(n\) is even, \(\zeta_{n/2} = -1\) is also a root, contributing:

\[\frac{1}{n} \cdot \frac{-1}{x - (-1)} = -\frac{1}{n(x + 1)}\]

\textbf{Quadratic factors.} The non-real roots pair at angles
\(\phi_k = 2\pi k/n\) for appropriate \(k\), yielding quadratics
\(x^2 - 2\cos\phi_k \cdot x + 1\). The integration proceeds analogously,
with coefficients determined by the same residue-pairing method.

\hypertarget{general-rational-integrands}{%
\subsection{General rational
integrands}\label{general-rational-integrands}}

The methodology extends to any integral
\(\displaystyle\int\frac{R(x)}{P(x)}\,dx\) where \(P\) has simple roots
\(\{\alpha_j\}\). After polynomial long division if
\(\deg R \geq \deg P\), the proper rational part decomposes as:

\[\frac{R(x)}{P(x)} = \sum_j \frac{R(\alpha_j)}{P'(\alpha_j)} \cdot \frac{1}{x - \alpha_j} + \text{(polynomial terms)}\]

The procedure then follows three steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Decompose} using the residue formula above.
\item
  \textbf{Pair conjugates} to obtain real quadratic denominators.
\item
  \textbf{Integrate} each quadratic term via the identity:
\end{enumerate}

\[\int\frac{Ax + B}{(x - c)^2 + s^2}\,dx = \frac{A}{2}\ln\bigl((x-c)^2 + s^2\bigr) + \frac{B + Ac}{s}\arctan\frac{x - c}{s} + C\]

When \(P\) has repeated roots, the partial fraction decomposition
includes higher-order terms \((x - \alpha)^{-m}\), which integrate to
rational functions (for \(m \geq 2\)) plus logarithms (for \(m = 1\)).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{concluding-remarks}{%
\section{Concluding Remarks}\label{concluding-remarks}}

The integral \(\displaystyle\int\frac{dx}{x^n + 1}\) admits a closed
form expressible as a finite sum of logarithmic and arctangent terms.
The derivation rests on three principles:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Residue-based partial fractions.} For simple roots,
  \(r_j = 1/P'(\alpha_j)\).
\item
  \textbf{Conjugate pairing.} Non-real roots \(\omega, \bar{\omega}\)
  contribute the real quadratic
  \((x - \omega)(x - \bar{\omega}) = x^2 - 2\operatorname{Re}(\omega)x + 1\).
\item
  \textbf{Quadratic integration.} The numerator decomposes into a
  multiple of the derivative (yielding \(\ln\)) plus a constant
  (yielding \(\arctan\)).
\end{enumerate}

The particularly elegant coefficient formulae \(A_k = -2c_k/n\) and
\(B_k = 2/n\) arise from the algebraic relation \(\omega_j^n = -1\),
which forces \(r_j = -\omega_j/n\). For the family \(x^n - 1\), the
relation \(\zeta_j^n = 1\) yields \(r_j = \zeta_j/n\) instead. For
general polynomials, the residues \(r_j = R(\alpha_j)/P'(\alpha_j)\) do
not simplify to such universal expressions, though the
decomposition-and-pairing method remains fully applicable.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\newpage

\hypertarget{appendix-algorithmic-summary}{%
\section{Appendix: Algorithmic
Summary}\label{appendix-algorithmic-summary}}

To evaluate \(\displaystyle\int\frac{dx}{x^n + 1}\):

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Compute} \(\theta_k = \pi(2k+1)/n\) for
  \(k = 0, 1, \ldots, \lfloor(n-2)/2\rfloor\).
\item
  \textbf{Evaluate} \(c_k = \cos\theta_k\) and \(s_k = \sin\theta_k\).
\item
  \textbf{If \(n\) is odd}, include the term \(\dfrac{1}{n}\ln|x + 1|\).
\item
  \textbf{For each \(k\)}, add:

  \begin{itemize}
  \tightlist
  \item
    \(-\dfrac{c_k}{n}\ln(x^2 - 2c_k x + 1)\)
  \item
    \(\dfrac{2s_k}{n}\arctan\dfrac{x - c_k}{s_k}\)
  \end{itemize}
\item
  \textbf{Add} the constant of integration \(C\).
\end{enumerate}

\end{document}
