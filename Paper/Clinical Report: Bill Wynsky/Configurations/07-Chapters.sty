%%% Chapters and Sections %%%

\definecolor{burgundy}{RGB}{128,0,32}

% Classic style
\ifthenelse{\equal{\ChapterOption}{classic}}{
    \titleformat{\chapter}[display]%
    {\raggedleft\huge}%
    {\raggedleft\minionsubheadfont\fontsize{96}{10}\bfseries%
        {\color{burgundy}\addfontfeature{LetterSpace=4}\thechapter}}%
    {15pt}%
    {\hspace{2cm}\miniondisplayfont\fontsize{36}{42}\selectfont\addfontfeature{LetterSpace=2}}%
    
    \titlespacing*{\chapter}{0pt}{-30pt}{40pt}
}{}

% Fancy style
\ifthenelse{\equal{\ChapterOption}{fancy}}{
    \titleformat{\chapter}[display]
    {\flushright\normalsize\huge\color{black}}%
    {\flushright\normalsize%
        {\minionsubheadfont\fontsize{32}{34}\selectfont\bfseries%
        \textcolor{burgundy!60}{\rule[-4pt]{2pt}{40pt}}\hspace{1em}%
        \raisebox{8pt}{\color{burgundy}\addfontfeature{LetterSpace=6}\thechapter}}}%
    {18pt}%
    {\miniondisplayfont\addfontfeature{LetterSpace=12}\fontsize{28}{34}\selectfont}%
    
    \titlespacing*{\chapter}{0pt}{-30pt}{45pt}
}{}

% Modern style
\ifthenelse{\equal{\ChapterOption}{modern}}{
    \titleformat{\chapter}[display]
    {\normalsize\huge\color{black}}%
    {\minionsubheadfont\flushright\fontsize{92}{10}\bfseries%
        {\color{burgundy}\addfontfeature{LetterSpace=0}%
        \raisebox{10pt}{\thechapter}}%
    }{20pt}%
    {\miniondisplayfont\addfontfeature{LetterSpace=16}\fontsize{26}{32}\selectfont%
        \MakeUppercase}%
    
    \titlespacing*{\chapter}{0pt}{-30pt}{50pt}
}{}

% Part formatting - elegant full-page design
\makeatletter
\renewcommand\part{%
  \if@openright
    \cleardoublepage
  \else
    \clearpage
  \fi
  \thispagestyle{empty}%
  \if@twocolumn
    \onecolumn
    \@tempswatrue
  \else
    \@tempswafalse
  \fi
  \null\vfil
  \secdef\@part\@spart}

\def\@part[#1]#2{%
    \ifnum \c@secnumdepth >-2\relax
      \refstepcounter{part}%
      \addcontentsline{toc}{part}{\thepart\hspace{1em}#1}%
    \else
      \addcontentsline{toc}{part}{#1}%
    \fi
    \markboth{}{}%
    {\centering
     \interlinepenalty \@M
     \normalfont
     \miniondisplayfont\fontsize{14}{18}\selectfont\addfontfeature{LetterSpace=12}%
     \MakeUppercase{\partname\nobreakspace\thepart}%
     \par
     \vskip 2.5em
     \miniondisplayfont\fontsize{32}{40}\selectfont\addfontfeature{LetterSpace=3}%
     #2\par}%
    \@endpart}

\def\@spart#1{%
    {\centering
     \interlinepenalty \@M
     \normalfont
     \miniondisplayfont\fontsize{32}{40}\selectfont\addfontfeature{LetterSpace=3}%
     #1\par}%
    \@endpart}

\def\@endpart{\vfil\newpage
              \if@twoside
               \if@openright
                \null
                \thispagestyle{empty}%
                \newpage
               \fi
              \fi
              \if@tempswa
                \twocolumn
              \fi}
\makeatother

% Section formatting - BODY TEXT SIZE (11pt/13.2pt)
\titleformat{\section}
    {\minionfont\fontsize{11pt}{13.2pt}\selectfont\bfseries}
    {\textcolor{burgundy}{\thesection}}
    {1em}
    {}

\titlespacing*{\section}{0pt}{13.2pt}{0pt}

% Subsection formatting - BODY TEXT SIZE (11pt/13.2pt) - NO ITALIC
\titleformat{\subsection}
    {\minionfont\fontsize{11pt}{13.2pt}\selectfont\bfseries}
    {\textcolor{burgundy}{\thesubsection}}
    {1em}
    {}

\titlespacing*{\subsection}{0pt}{13.2pt}{0pt}

% Subsubsection formatting - runs into paragraph
\titleformat{\subsubsection}[runin]
    {\minionfont\fontsize{11pt}{13.2pt}\selectfont\itshape}
    {\textcolor{burgundy!80}{\thesubsubsection}}
    {0.8em}
    {}
    [.]

\titlespacing*{\subsubsection}{0pt}{6.6pt}{0.5em}