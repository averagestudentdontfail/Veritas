---
title: "The Integral of 1/(xâ¿ + 1)"
subtitle: "A Complete Treatment"
date: "December 2025"
lang: en
chapterstyle: minimal
---

# Preliminaries

Let $n \geq 2$ be a positive integer. The polynomial $P(x) = x^n + 1$ has $n$ distinct roots in $\mathbb{C}$, obtained by solving $x^n = -1 = e^{i\pi(2m+1)}$ for any integer $m$:

$$\omega_j := e^{i\pi(2j+1)/n}, \qquad j = 0, 1, \ldots, n-1$$

These roots lie on the unit circle, equally spaced at angular intervals of $2\pi/n$, with the first root at angle $\pi/n$ from the positive real axis.

**Conjugate structure.** The roots satisfy $\overline{\omega_j} = \omega_{n-1-j}$. When $n$ is odd, exactly one root is real: $\omega_{(n-1)/2} = e^{i\pi} = -1$. When $n$ is even, all roots are non-real.

**Index convention.** For each $k \in \{0, 1, \ldots, \lfloor(n-2)/2\rfloor\}$, define:

$$\theta_k := \frac{\pi(2k+1)}{n} \in (0, \pi)$$

$$c_k := \cos\theta_k, \qquad s_k := \sin\theta_k > 0$$

$$Q_k(x) := x^2 - 2c_k x + 1 = (x - c_k)^2 + s_k^2$$

The restriction $\theta_k \in (0, \pi)$ ensures $s_k > 0$ and selects exactly one representative from each conjugate pair of non-real roots.

**Lemma (Real Factorisation).** *The polynomial $x^n + 1$ factors over $\mathbb{R}$ as follows:*

*Case I ($n$ odd):*
$$x^n + 1 = (x + 1)\prod_{k=0}^{(n-3)/2} Q_k(x)$$

*Case II ($n$ even):*
$$x^n + 1 = \prod_{k=0}^{n/2-1} Q_k(x)$$

*Proof.* Each conjugate pair $\omega_j, \overline{\omega_j}$ with argument $\theta \in (0, \pi)$ (i.e., $\omega_j = e^{i\theta}$, $\overline{\omega_j} = e^{-i\theta}$ for a unique $\theta = \theta_k$) contributes the real quadratic $(x - \omega_j)(x - \overline{\omega_j}) = x^2 - 2\operatorname{Re}(\omega_j)x + |\omega_j|^2 = Q_k(x)$. The quadratics are irreducible over $\mathbb{R}$ since their discriminant $4c_k^2 - 4 = -4s_k^2 < 0$. For odd $n$, the real root $\omega_{(n-1)/2} = -1$ contributes the linear factor $(x + 1)$. Counting degrees: for odd $n$, $(n-1)/2$ quadratics contribute degree $n - 1$, plus one linear factor, totalling $n$; for even $n$, $n/2$ quadratics contribute degree $n$. $\blacksquare$

---

# Main Theorem

**Theorem.** *An antiderivative of $\dfrac{1}{x^n + 1}$ is given by:*

*Case I ($n$ odd):*
$$\int\frac{dx}{x^n+1} = \frac{1}{n}\ln|x+1| + \sum_{k=0}^{(n-3)/2}\left[-\frac{c_k}{n}\ln Q_k(x) + \frac{2s_k}{n}\arctan\frac{x - c_k}{s_k}\right] + C$$

*Case II ($n$ even):*
$$\int\frac{dx}{x^n+1} = \sum_{k=0}^{n/2-1}\left[-\frac{c_k}{n}\ln Q_k(x) + \frac{2s_k}{n}\arctan\frac{x - c_k}{s_k}\right] + C$$

*where $c_k = \cos\theta_k$, $s_k = \sin\theta_k$, $\theta_k = \pi(2k+1)/n$, and $Q_k(x) = x^2 - 2c_k x + 1$.*

**Domain of validity.** For odd $n$, the formula holds on $(-\infty, -1)$ and $(-1, \infty)$ separately, with potentially different constants of integration on each interval. For even $n$, the formula holds on all of $\mathbb{R}$.

---

# Proof

The argument proceeds in three steps: partial fraction decomposition via residues, reduction to real form by pairing conjugate roots, and integration of each component term.

## Step 1. Partial Fraction Decomposition

Since $P(x) = x^n + 1$ has derivative $P'(x) = nx^{n-1}$, and $P'(\omega_j) = n\omega_j^{n-1} \neq 0$ for all $j$, the roots are simple. For a polynomial with simple roots $\{\alpha_j\}$, the partial fraction decomposition of $1/P(x)$ takes the form:

$$\frac{1}{P(x)} = \sum_j \frac{r_j}{x - \alpha_j}, \qquad r_j = \operatorname{Res}_{x = \alpha_j}\frac{1}{P(x)} = \frac{1}{P'(\alpha_j)}$$

To verify this identity, observe that both sides are rational functions with the same simple poles and the same principal part at each pole. Their difference is therefore a rational function with no poles, hence a polynomial. Since this difference tends to $0$ as $x \to \infty$, it must be identically $0$.

Applying this to $P(x) = x^n + 1$ with roots $\omega_j$:

$$r_j = \frac{1}{P'(\omega_j)} = \frac{1}{n\omega_j^{n-1}}$$

To simplify, observe that $\omega_j^n = -1$ implies $\omega_j^{n-1} = \omega_j^n / \omega_j = -\omega_j^{-1}$. Therefore:

$$r_j = \frac{1}{n(-\omega_j^{-1})} = -\frac{\omega_j}{n}$$

This yields the complex partial fraction decomposition:

$$\frac{1}{x^n + 1} = -\frac{1}{n}\sum_{j=0}^{n-1}\frac{\omega_j}{x - \omega_j}$$

When $n$ is odd, the index $j = (n-1)/2$ corresponds to $\omega_j = e^{i\pi} = -1$, and the associated term is:

$$-\frac{1}{n} \cdot \frac{-1}{x - (-1)} = \frac{1}{n} \cdot \frac{1}{x + 1}$$

## Step 2. Pairing Conjugate Roots

For each index $k$ in the range $\{0, 1, \ldots, \lfloor(n-2)/2\rfloor\}$, let $\omega = \omega_k = e^{i\theta_k}$ and $\bar{\omega} = e^{-i\theta_k}$ be the corresponding conjugate pair (indeed $\bar{\omega} = \omega_{n-1-k}$). Their combined contribution to the partial fraction decomposition is:

$$-\frac{1}{n}\left(\frac{\omega}{x - \omega} + \frac{\bar{\omega}}{x - \bar{\omega}}\right) = -\frac{1}{n} \cdot \frac{\omega(x - \bar{\omega}) + \bar{\omega}(x - \omega)}{(x - \omega)(x - \bar{\omega})}$$

**Denominator.** Using $\omega + \bar{\omega} = 2\cos\theta_k = 2c_k$ and $\omega\bar{\omega} = |\omega|^2 = 1$:

$$(x - \omega)(x - \bar{\omega}) = x^2 - (\omega + \bar{\omega})x + \omega\bar{\omega} = x^2 - 2c_k x + 1 = Q_k(x)$$

**Numerator.** Expanding:

$$\omega(x - \bar{\omega}) + \bar{\omega}(x - \omega) = (\omega + \bar{\omega})x - \omega\bar{\omega} - \bar{\omega}\omega = 2c_k x - 2$$

Therefore the paired fraction becomes:

$$-\frac{1}{n} \cdot \frac{2c_k x - 2}{Q_k(x)} = \frac{A_k x + B_k}{Q_k(x)}$$

with coefficients:

$$A_k = -\frac{2c_k}{n}, \qquad B_k = \frac{2}{n}$$

## Step 3. Integration of Quadratic Terms

Fix an index $k$, and write $c = c_k$, $s = s_k$, $Q(x) = Q_k(x) = (x - c)^2 + s^2$, $A = A_k$, $B = B_k$. Note that $Q'(x) = 2(x - c)$.

**Numerator decomposition.** We seek constants $\alpha$ and $\beta$ such that:

$$Ax + B = \alpha \cdot Q'(x) + \beta = 2\alpha(x - c) + \beta$$

Matching coefficients: $2\alpha = A$ and $-2\alpha c + \beta = B$. Hence $\alpha = A/2$ and $\beta = B + Ac$.

**Evaluation of $\beta$:**

$$\beta = B + Ac = \frac{2}{n} + \left(-\frac{2c}{n}\right)c = \frac{2}{n}(1 - c^2) = \frac{2s^2}{n}$$

**Integration.** The integral separates into two standard forms:

$$\int\frac{Ax + B}{Q(x)}\,dx = \frac{A}{2}\int\frac{Q'(x)}{Q(x)}\,dx + \beta\int\frac{dx}{(x-c)^2 + s^2}$$

The first integral is $\ln Q(x)$. For the second, the substitution $u = (x - c)/s$ gives $du = dx/s$, whence:

$$\int\frac{dx}{(x-c)^2 + s^2} = \int\frac{s\,du}{s^2(u^2 + 1)} = \frac{1}{s}\arctan u = \frac{1}{s}\arctan\frac{x-c}{s}$$

Substituting $A/2 = -c/n$ and $\beta/s = 2s^2/(ns) = 2s/n$:

$$\int\frac{Ax + B}{Q(x)}\,dx = -\frac{c}{n}\ln Q(x) + \frac{2s}{n}\arctan\frac{x - c}{s} + C$$

**Assembly.** Summing over all conjugate pairs (indexed by $k$) and including the linear term $(1/n)\ln|x + 1|$ when $n$ is odd yields the stated formula. $\blacksquare$

---

# Complex Logarithmic Form

**Corollary.** *On any simply connected domain $D \subset \mathbb{C}$ avoiding the roots $\{\omega_j\}$, with a fixed branch of $\log$ on $D$:*

$$\int\frac{dx}{x^n+1} = -\frac{1}{n}\sum_{j=0}^{n-1}\omega_j\log(x - \omega_j) + C$$

*Proof.* Integrate the complex partial fraction decomposition term by term. $\blacksquare$

**Remark on branches.** On a simply connected domain avoiding the poles, fixing a branch of $\log$ renders the expression single-valued. Changing branches shifts the result by a constant, since the derivative is unchanged. Choose $D$ to be conjugation-invariant (i.e., $z \in D \Rightarrow \bar{z} \in D$) and choose a branch of $\log$ on $D$ satisfying $\log(\bar{z}) = \overline{\log z}$. Then for real $x \in D$, we have $\overline{x - \omega} = x - \bar{\omega}$, so $\log(x - \bar{\omega}) = \overline{\log(x - \omega)}$. Hence $\omega\log(x - \omega) + \bar{\omega}\log(x - \bar{\omega})$ is real, and pairing conjugates yields a real-valued antiderivative; branch changes affect only the additive constant on each component.

---

# Application: The Case $n = 5$

Setting $n = 5$, the index set is $k \in \{0, 1\}$, corresponding to angles $\theta_0 = \pi/5$ and $\theta_1 = 3\pi/5$.

**Trigonometric values.** The cosine values follow from the identity $\cos(\pi/5) = (1 + \sqrt{5})/4$ and $\cos(3\pi/5) = -\cos(2\pi/5) = (1 - \sqrt{5})/4$. The sine values follow from $\sin^2\theta + \cos^2\theta = 1$:

| | $k = 0$ | $k = 1$ |
|:--|:--|:--|
| $\theta_k$ | $\pi/5$ | $3\pi/5$ |
| $c_k$ | $(1 + \sqrt{5})/4$ | $(1 - \sqrt{5})/4$ |
| $s_k$ | $\sqrt{10 - 2\sqrt{5}}/4$ | $\sqrt{10 + 2\sqrt{5}}/4$ |
| $-c_k/5$ | $-(1 + \sqrt{5})/20$ | $(\sqrt{5} - 1)/20$ |
| $2s_k/5$ | $\sqrt{10 - 2\sqrt{5}}/10$ | $\sqrt{10 + 2\sqrt{5}}/10$ |

**Arctangent arguments.** For $k = 0$:

$$\frac{x - c_0}{s_0} = \frac{x - \frac{1 + \sqrt{5}}{4}}{\frac{\sqrt{10 - 2\sqrt{5}}}{4}} = \frac{4x - 1 - \sqrt{5}}{\sqrt{10 - 2\sqrt{5}}}$$

For $k = 1$:

$$\frac{x - c_1}{s_1} = \frac{x - \frac{1 - \sqrt{5}}{4}}{\frac{\sqrt{10 + 2\sqrt{5}}}{4}} = \frac{4x - 1 + \sqrt{5}}{\sqrt{10 + 2\sqrt{5}}}$$

**Final formula:**

$$\int\frac{dx}{x^5 + 1} = \frac{1}{5}\ln|x+1| - \frac{1 + \sqrt{5}}{20}\ln\left(x^2 - \frac{1+\sqrt{5}}{2}x + 1\right) + \frac{\sqrt{5}-1}{20}\ln\left(x^2 + \frac{\sqrt{5}-1}{2}x + 1\right)$$

$$+ \frac{\sqrt{10 - 2\sqrt{5}}}{10}\arctan\frac{4x - 1 - \sqrt{5}}{\sqrt{10 - 2\sqrt{5}}} + \frac{\sqrt{10 + 2\sqrt{5}}}{10}\arctan\frac{4x - 1 + \sqrt{5}}{\sqrt{10 + 2\sqrt{5}}} + C$$

---

# Generalisations

## The family $x^n + a^n$

For real $a \neq 0$, the substitution $x = au$ yields:

$$\int\frac{dx}{x^n + a^n} = \frac{1}{a^{n-1}}\int\frac{du}{u^n + 1}$$

The main theorem then applies directly to the transformed integral.

## The family $x^n - 1$

The roots of $x^n - 1 = 0$ are $\zeta_j = e^{2\pi i j/n}$ for $j = 0, 1, \ldots, n-1$. The same method yields residues:

$$r_j = \frac{1}{n\zeta_j^{n-1}} = \frac{\zeta_j}{n}$$

since $\zeta_j^n = 1$ implies $\zeta_j^{n-1} = \zeta_j^{-1}$. The decomposition becomes:

$$\frac{1}{x^n - 1} = \frac{1}{n}\sum_{j=0}^{n-1}\frac{\zeta_j}{x - \zeta_j}$$

**Real roots.** The polynomial $x^n - 1$ always has the real root $\zeta_0 = 1$, contributing a term:

$$\frac{1}{n} \cdot \frac{1}{x - 1}$$

When $n$ is even, $\zeta_{n/2} = -1$ is also a root, contributing:

$$\frac{1}{n} \cdot \frac{-1}{x - (-1)} = -\frac{1}{n(x + 1)}$$

**Quadratic factors.** The non-real roots pair at angles $\phi_k = 2\pi k/n$ for appropriate $k$, yielding quadratics $x^2 - 2\cos\phi_k \cdot x + 1$. The integration proceeds analogously, with coefficients determined by the same residue-pairing method.

## General rational integrands

The methodology extends to any integral $\displaystyle\int\frac{R(x)}{P(x)}\,dx$ where $P$ has simple roots $\{\alpha_j\}$. After polynomial long division if $\deg R \geq \deg P$, the proper rational part decomposes as:

$$\frac{R(x)}{P(x)} = \sum_j \frac{R(\alpha_j)}{P'(\alpha_j)} \cdot \frac{1}{x - \alpha_j} + \text{(polynomial terms)}$$

The procedure then follows three steps:

1. **Decompose** using the residue formula above.

2. **Pair conjugates** to obtain real quadratic denominators.

3. **Integrate** each quadratic term via the identity:

$$\int\frac{Ax + B}{(x - c)^2 + s^2}\,dx = \frac{A}{2}\ln\bigl((x-c)^2 + s^2\bigr) + \frac{B + Ac}{s}\arctan\frac{x - c}{s} + C$$

When $P$ has repeated roots, the partial fraction decomposition includes higher-order terms $(x - \alpha)^{-m}$, which integrate to rational functions (for $m \geq 2$) plus logarithms (for $m = 1$).

---

# Concluding Remarks

The integral $\displaystyle\int\frac{dx}{x^n + 1}$ admits a closed form expressible as a finite sum of logarithmic and arctangent terms. The derivation rests on three principles:

1. **Residue-based partial fractions.** For simple roots, $r_j = 1/P'(\alpha_j)$.

2. **Conjugate pairing.** Non-real roots $\omega, \bar{\omega}$ contribute the real quadratic $(x - \omega)(x - \bar{\omega}) = x^2 - 2\operatorname{Re}(\omega)x + 1$.

3. **Quadratic integration.** The numerator decomposes into a multiple of the derivative (yielding $\ln$) plus a constant (yielding $\arctan$).

The particularly elegant coefficient formulae $A_k = -2c_k/n$ and $B_k = 2/n$ arise from the algebraic relation $\omega_j^n = -1$, which forces $r_j = -\omega_j/n$. For the family $x^n - 1$, the relation $\zeta_j^n = 1$ yields $r_j = \zeta_j/n$ instead. For general polynomials, the residues $r_j = R(\alpha_j)/P'(\alpha_j)$ do not simplify to such universal expressions, though the decomposition-and-pairing method remains fully applicable.

---

\newpage

# Appendix: Algorithmic Summary

To evaluate $\displaystyle\int\frac{dx}{x^n + 1}$:

1. **Compute** $\theta_k = \pi(2k+1)/n$ for $k = 0, 1, \ldots, \lfloor(n-2)/2\rfloor$.

2. **Evaluate** $c_k = \cos\theta_k$ and $s_k = \sin\theta_k$.

3. **If $n$ is odd**, include the term $\dfrac{1}{n}\ln|x + 1|$.

4. **For each $k$**, add:
   - $-\dfrac{c_k}{n}\ln(x^2 - 2c_k x + 1)$
   - $\dfrac{2s_k}{n}\arctan\dfrac{x - c_k}{s_k}$

5. **Add** the constant of integration $C$.
